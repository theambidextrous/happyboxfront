<?php
session_start();
require_once('../lib/Util.php');
require_once('../lib/User.php');
$util = new Util();
$user = new User();
$util->ShowErrors();

?>
<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Happy Box:: Become a partner</title>
  <!-- Bootstrap core CSS -->
 <?php include '../shared/partials/css.php'; ?>

</head>

<body>
  <!-- Navigation -->
 <?php include '../shared/partials/nav.php'; ?>
 <section  class="blue_band text-center">
			<h2 class="">HAPPYBOX PARTNER PORTAL</h2>
			</section>
  <section  class="green_strip text-center">
			<h4 class="partner_blue2">Becoming a HAPPYBOX partner means you are always a winner!</h4>
			</section>
  
<section class=" text-center ">
            <div class="container">
		
               
                    <div class="row justify-content-center become_boxes">
                    <div class="col-md-6">
                        <div class="become_card become_card1">
                           <div class="become_card_txt">Free advertising year round on our website and in our boxes</div>
                            <img src="../shared/img/becomecard1a.svg" class=""/>
                            
                        </div>		
                        </div>
                         <div class="col-md-6">
                        <div class="become_card become_card2">
                       <span class="become_card_txt">Zero upfront cost, Zero cash out, Zero investment</span>
                           
                            <img src="../shared/img/become-card2.svg" class=""/>
                            
                        </div>		
                        </div>
                          <div class="col-md-6">
                        <div class="become_card become_card3">
                           <span class="become_card_txt">Increase your turnaround by attracting a new typology of clientele</span>
                            <img src="../shared/img/become-card3.svg" class=""/>
                            
                        </div>		
                        </div>
                          <div class="col-md-6">
                        <div class="become_card become_card4">
                        <span class="become_card_txt">Easy going partnership with Zero constraint, 100% independence on your bookings, all made under your T&Câ€™s</span>
                            <img src="../shared/img/become-card4.svg" class=""/>
                            
                        </div>		
                        </div>
                         <div class="col-md-12 text-center">
                             <button class="btn btn-block btn-zero">0% RISK AND 100% WIN  <img src="../shared/img/icons/icn-arrow-blue.svg" class="become_arrow"/></button>	
                        </div>

                </div>
              </div>
        </section>
  <!--become partner steps-->
  <section class=" text-center become_partner_steps pad_top20">
            <div class="container">
		
               
                    <div class="row ">
                    <div class="col-md-6">
                        <div class="card become_part_card">
                            <div>
                                <span class="become_badge">1</span>
                            </div>
                            <div class="become_part_card_txt">
                                <h4>  Sign your contract and annex</h4>
                         We will support you in defining the best set of services you want to promote.         
                                
                            </div>                          
                        </div>  
                    </div>
       <div class="col-md-6">
                        <div class="card become_part_card">
                            <div>
                                <span class="become_badge">2</span>
                            </div>
                            <div class="become_part_card_txt">
                                <h4>  Check and control your promoted services</h4>
                       Through your Partner Portal personalised access.        
                                
                            </div>                          
                         </div>
   </div>
       <!--row 2-->
<div class="col-md-6">
                        <div class="card become_part_card">
                            <div>
                                <span class="become_badge">3</span>
                            </div>
                            <div class="become_part_card_txt">
                                <h4>  Your services are published and promoted</h4>
               On our website and our boxes.
                                
                            </div>                           
                        </div>
  
       </div>
       <div class="col-md-6">
                        <div class="card become_part_card">
                            <div>
                                <span class="become_badge">4</span>
                            </div>
                            <div class="become_part_card_txt">
                                <h4>      Execute the service</h4>
                    Get paid once the service has been executed.        
                                
                            </div>
                             
                            
                            
                        </div>
  
       </div>
       <!--3-->
       <div class="col-md-6">
                        <div class="card become_part_card">
                            <div>
                                <span class="become_badge">5</span>
                            </div>
                            <div class="become_part_card_txt">
                                <h4>    Execute the service</h4>
                      Get paid once the service has been executed.         
                                
                            </div>                           
                        </div>
  
       </div>
       <div class="col-md-6">
                        <div class="card become_part_card">
                            <div>
                                <span class="become_badge">6</span>
                            </div>
                            <div class="become_part_card_txt">
                                <h4>Our Partner Care Team is available alongside you at each step.</h4>
                                
                            </div>
                             
                            
                            
                        </div>
  
       </div>
       <!--4-->
       <div class="col-md-6">
                        <div class="card become_part_card card_step_blue">
                            <div class="card_step_blue_txt text-white"> These Partners trust us with their promotion </div>
                        
                                                    
                        </div>
  
       </div>
       <div class="col-md-6 nomargin_lr">
                        <div class="become_logos row row_no_margin">
                            <div class="col-3 ">
                                <div class="become_logos_item">
                                     <div class="">
                                    Partner<br>
                                Logo
                                </div>
                                    
                                </div>                           
                           </div>   
                             <div class="col-3 ">
                                <div class="become_logos_item">
                                     <div class="">
                                    Partner<br>
                                Logo
                                </div>
                                    
                                </div>                           
                           </div> 
                            
                               <div class="col-3 ">
                                <div class="become_logos_item">
                                     <div class="">
                                    Partner<br>
                                Logo
                                </div>
                                    
                                </div>                           
                           </div> 
                               <div class="col-3 ">
                                <div class="become_logos_item">
                                     <div class="">
                                    Partner<br>
                                Logo
                                </div>
                                    
                                </div>                           
                           </div> 
                             
                            
                            
                        </div>
  
       </div>
                </div>
              </div>
        </section>
    <section class=" text-center  ">
            <div class="container sound_good_wrap">
			<div class="col-md-12 sound_good">
                <div class="row justify-content-center ">
                    <div class="col-md-10">
                          <h3 class="partner_blueh">Sound Good?</h3>
                  <p class="forgot_des text-center">Complete the form below to beconme a HAPPYBOX Partner                     </p>
                    <?php
                    if(!isset($_SESSION['frm'])){
                        $_SESSION['frm'] = [];
                    }
                    if( isset($_POST['becomeptn'])){
                        try{
                            $_SESSION['frm'] = $_POST;
                            if($_POST['business_category'] == 'nn'){
                                print $util->error_flash('Business category not selected');
                            }else{
                                $username = explode('@', $_POST['email'])[0];
                            $password = $util->createCode(10);
                            $u = new User($username, $_POST['email'], $password, $password);
                            /** register */
                            $u_resp = $u->new_partner('none');
                            // print $u_resp;
                            if( json_decode($u_resp)->status == 0 && json_decode($u_resp)->data->id > 0){
                                $created_user_id = json_decode($u_resp)->data->id;
                                $token = json_decode($u_resp)->data->token;
                                /** reset password */
                                $reset_resp = $u->pwd_reset_link();
                                // print($reset_resp);
                                if(json_decode($reset_resp)->status == 0){
                                    /** complete profile */
                                    $body = [
                                        'fname' => $_POST['fname'],
                                        'mname' => $_POST['mname'],
                                        'sname' => $_POST['sname'],
                                        'short_description' => $_POST['short_description'],
                                        'location' => $_POST['location'],
                                        'phone' => $_POST['phone'],
                                        'business_name' => $_POST['business_name'],
                                        'business_category' => $_POST['business_category'],
                                        'business_reg_no' => $_POST['business_reg_no']
                                    ];
                                    $prof_resp = $u->add_details_partner($body, $token, $created_user_id);
                                    // print $prof_resp;
                                    if(json_decode($prof_resp)->status == 0 && json_decode($prof_resp)->userid > 0){
                                        // unset($_SESSION['frm']);
                                        print $util->success_flash('Account created! It will be approved by admins. A message containing password reset link has been send your email address');
                                    }else{
                                        print $util->error_flash(json_decode($prof_resp)->message);
                                    }
                                }else{
                                    print $util->error_flash(json_decode($reset_resp)->message);
                                }
                            }else{
                                print $util->error_flash(json_decode($u_resp)->message);
                            }
                            }
                        }catch(Exception $e){
                            print $util->error_flash($e->getMessage());
                        }
                    }
                    ?>
                    </div>
                      <div class="col-md-10">
                          <div class="row justify-content-center become_partner_form">
                              <div class="col-md-5 become_partner_form">
                                <form class="" method="post">
                                    <div class="form-group">
                                        <label class="text-left">Company Name</label>
                                        <input type="text" name="business_name" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['business_name']?>">
                                    </div>
                                    <div class="form-group">
                                        <label class="text-left">Company Registration No.</label>
                                        <input type="text" name="business_reg_no" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['business_reg_no']?>">
                                    </div>
                                    <div class="form-group">
                                        <label>Contact Person's First Name</label>
                                        <input type="text" name="fname" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['fname']?>">
                                    </div>
                                    <div class="form-group">
                                        <label>Contact Person's Surname</label>
                                        <input type="text" name="sname" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['sname']?>">
                                    </div>
                                    <div class="form-group">
                                        <label>Contact Mobile Number</label>
                                        <input type="text" name="phone" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['phone']?>">
                                    </div> 
                                </div>
                                    <div class="col-md-5">
                                        <div class="form-group">
                                            <label>Business Category</label>
                                            <select class=" form-control rounded_form_control" name="business_category">
                                            <option value="nn">Select an option</option>
                                            <option>Well-Being</option>
                                            <option>Adventure</option>
                                            <option>Sports</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="text-left">Business Short Description</label>
                                            <input type="text" name="short_description" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['short_description']?>">
                                        </div>
                                        <div class="form-group">
                                            <label>Contact Person's Other Name</label>
                                            <input type="text" name="mname" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['mname']?>">
                                        </div>
                                        <div class="form-group">
                                            <label>Email Address</label>
                                            <input type="email" name="email" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['email']?>">
                                        </div>
                                        <div class="form-group">
                                            <label>Business Location</label>
                                            <input type="text" name="location" class="form-control rounded_form_control" placeholder="Required Field" value="<?=$_SESSION['frm']['location']?>">
                                        </div>
                                        <button type="submit" name="becomeptn" class="btn btn_rounded btn-dark-blue">BECOME A PARTNER</button>
                                    </div>
                                </form>
                              
                              
                          </div>
                        
                    </div>
                    
                </div>    </div>
              
		
               
                </div>
    </section>
  <?php include '../shared/partials/partners.php';?>
  
   <!--end become partner steps-->
   <!--start sound good-->
   
   <!--end start good-->

<?php include '../shared/partials/footer.php';?>
  <!-- Page Content -->

  <!-- Bootstrap core JavaScript -->
  
<?php include '../shared/partials/js.php';?>
   

 

</body>

</html>


